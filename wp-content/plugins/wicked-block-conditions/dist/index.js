!function(e){var t={};function n(o){if(t[o])return t[o].exports;var i=t[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=e,n.c=t,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(o,i,function(t){return e[t]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="http://localhost:88/assets/",n(n.s=0)}({"./src/data/index.js":function(e,t){function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var o=wp.apiFetch,i=wp.data,a=i.registerStore,c=(i.withSelect,{setUserRoles:function(e){return{type:"SET_USER_ROLES",userRoles:e}},receiveUserRoles:function(e){return{type:"RECEIVE_USER_ROLES",path:e}}});a("wicked-plugins/wicked-block-conditions",{reducer:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{userRoles:{}},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_USER_ROLES":return function(e){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{},i=Object.keys(o);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(o).filter(function(e){return Object.getOwnPropertyDescriptor(o,e).enumerable}))),i.forEach(function(t){n(e,t,o[t])})}return e}({},e,{userRoles:t.userRoles})}return e},actions:c,selectors:{receiveUserRoles:function(e){return e.userRoles}},controls:{RECEIVE_USER_ROLES:function(e){return o({path:e.path})}},resolvers:{receiveUserRoles:regeneratorRuntime.mark(function e(t){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.receiveUserRoles("/wicked-block-conditions/v1/user-roles/");case 2:return n=e.sent,e.abrupt("return",c.setUserRoles(n));case 4:case"end":return e.stop()}},e)})}})},"./src/index.js":function(e,t,n){"use strict";n.r(t);var o=lodash,i=o.find,a=o.forEach,c=o.isUndefined,r=o.filter,l=function e(t,n){var o=!1;return(o=i(t,function(e){return e.guid==n}))||a(t,function(t){var i=e(t.conditions,n);i&&(o=i)}),o},s=function e(t,n){return t.map(function(t){return t.guid==n.guid?n:(c(t.conditions)||(t.conditions=e(t.conditions,n)),t)})},u=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})},d=wp.i18n.__,p=wp.components.RadioControl,m=function(e){var t=e.option,n=e.onChange;return React.createElement(p,{label:d("When conditions are met:"),selected:t,options:[{label:d("Show this block"),value:"show"},{label:d("Hide this block"),value:"hide"}],onChange:function(e){n(e)}})},f=wp.i18n.__,g=wp.components,h=g.Button,v=g.Icon,b=function(e){var t=!1,n=e.condition,o=n.type,i=0!=e.index&&React.createElement("div",{className:"wbc-operator"},React.createElement("div",null,React.createElement("select",{defaultValue:n.operator,onChange:function(t){var n=Object.assign({},e.condition);n.operator=t.target.value,e.onChange(n)}},React.createElement("option",{value:"and"},f("And")),React.createElement("option",{value:"or"},f("Or")))));return t=n.conditions.length?React.createElement(w,{setState:e.setState,conditions:n.conditions,onChange:function(t){var n=Object.assign({},e.condition);n.conditions=t,e.onChange(n)}}):React.createElement("p",{className:"wbc-empty-group"},f("This group does not have any conditions yet.")),"group"==o?React.createElement("li",{className:"wbc-group-condition","data-guid":n.guid},i,React.createElement("div",{className:"wbc-content"},React.createElement("div",{className:"wbc-head"},React.createElement("h3",null,f("Condition Group"))),React.createElement("div",{className:"wbc-body"},t),React.createElement("div",{className:"wbc-foot"},React.createElement(h,{isLink:!0,onClick:function(){!function(t){e.setState(function(e){return{action:"select-condition",group:t.guid}})}(n)}},f("Add Condition")),React.createElement("span",{className:"wbc-separator"},"|"),React.createElement(h,{isLink:!0,onClick:function(){n.conditions.length?confirm(f("This will delete all conditions in the group.  Are you sure?"))&&e.onDelete(n):e.onDelete(n)}},f("Delete Group"))))):React.createElement("li",{className:"wbc-condition","data-guid":n.guid},i,React.createElement("div",{className:"wbc-content"},n.label),React.createElement("div",{className:"wbc-edit"},React.createElement(h,{onClick:function(){e.setState(function(e){return{action:"edit-condition",activeCondition:n.guid}})}},React.createElement(v,{icon:"admin-generic",size:"20"}))))};function R(){return(R=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var w=function(e){var t=function(t){var n=e.conditions.map(function(e){return e.guid==t.guid?t:e});e.onChange(n)},n=function(t){var n=e.conditions.filter(function(e){return e.guid!=t.guid});e.onChange(n)},o=e.conditions.map(function(o,i){return React.createElement(b,R({},e,{key:o.guid,index:i,condition:o,onChange:t,onDelete:n}))});return React.createElement("ul",{className:e.className||""},o)},E=wp.i18n.__,C=lodash.assign,k=wp.element.Fragment,y=wp.components.Button,x=function(e){var t=e.attributes.wickedBlockConditions,n=t.action,o=t.conditions,i=C({},e.attributes.wickedBlockConditions);return o.length?React.createElement(k,null,React.createElement(m,{option:n,onChange:function(t){i.action=t,e.setAttributes({wickedBlockConditions:i})}}),React.createElement(w,{setState:e.setState,conditions:o,onChange:function(t){i.conditions=t,e.setAttributes({wickedBlockConditions:i})},className:"wbc-conditions"}),React.createElement("p",null,React.createElement(y,{isLink:!0,onClick:function(){var t;t={guid:u(),type:"group",label:E("Condition Group"),operator:"and",conditions:[]},i.conditions=i.conditions.slice(0),i.conditions.push(t),e.setAttributes({wickedBlockConditions:i})}},E("Add Condition Group")))):React.createElement("div",{className:"wbc-start"},React.createElement("p",null,E("Show or hide this block based on conditions.  Add a condition to get started.")),React.createElement("p",null,React.createElement(y,{isLink:!0,onClick:function(){e.setState(function(e){return{action:"select-condition"}})}},E("Add Condition"))))},_=wp.i18n.__,S=lodash,O=S.assign,T=S.chain,N=(S.find,wp.element.Fragment),P=wp.components.Button,B=function(e){var t=function(){return{guid:u(),type:"group",label:_("Condition Group"),operator:"and",conditions:[]}},n=T(e.wickedBlockConditions.conditions).groupBy("group").map(function(e,t){return{name:t,conditions:e}}).value().map(function(n){var o=n.conditions.map(function(n){return React.createElement("li",null,React.createElement(P,{isLink:!0,onClick:function(){!function(n){var o={action:e.attributes.wickedBlockConditions.action,conditions:e.attributes.wickedBlockConditions.conditions.slice(0)},i=l(o.conditions,e.group),a=O({guid:u(),type:n.type,label:n.label,operator:"and",conditions:[]},n.default);i||(i=t(),o.conditions.push(i)),i.conditions.push(a),o.conditions=s(o.conditions,i),e.setAttributes({wickedBlockConditions:o}),n.bypassConfig?e.setState(function(e){return{action:"view-conditions"}}):e.setState(function(e){return{action:"edit-condition",activeCondition:a.guid}})}(n)}},n.label))});return React.createElement(N,null,React.createElement("h3",null,n.name),React.createElement("ul",null,o))});return React.createElement("div",{className:"wbc-select-condition"},React.createElement("p",null,_("Select a condition to add:")),n,React.createElement(P,{isDefault:!0,onClick:function(){e.setState(function(e){return{action:"view-conditions"}})}},_("Cancel")))},j=wp.i18n.__,D=(wp.element.Fragment,wp.components),U=D.TextControl,A=D.ToggleControl,F=D.Button,L=(wp.compose.withState,lodash),H=L.find,I=(L.isUndefined,L.forEach,L.assign),G=(L.cloneDeep,function(e){var t=l(e.attributes.wickedBlockConditions.conditions,e.activeCondition),n=H(e.wickedBlockConditions.conditions,{type:t.type}),o=Object.assign({},e.attributes.wickedBlockConditions),i=n.edit,a=function(){o.conditions=s(o.conditions,t),e.setAttributes({wickedBlockConditions:o})};return React.createElement("div",{className:"wbc-edit-condition"},React.createElement("h3",null,e.isNew?j("Add Condition"):j("Edit Condition"),": ",n.label),React.createElement("p",null,n.description),React.createElement(U,{label:j("Label"),help:j("Briefly explain what this condition does."),value:t.label,onChange:function(e){return n=e,t.label=n,void a();var n}}),React.createElement(A,{label:j("Negate condition"),checked:t.negate,help:j("Reverses the outcome of the condition."),onChange:function(e){t.negate=e,a()}}),React.createElement(i,{condition:t,onChange:function(e){t=I({},t,e),a()}}),React.createElement("div",{className:"wbc-foot"},React.createElement("div",{className:"wbc-save"},React.createElement(F,{isPrimary:!0,onClick:function(){e.setState(function(e){return{action:"view-conditions",activeCondition:null}})}},j("Save"))),React.createElement("div",{className:"wbc-delete"},React.createElement(F,{isDefault:!0,isDestructive:!0,onClick:function(){o.conditions=function e(t,n){return r(t,function(e){return e.guid!=n.guid}).map(function(t){return c(t.conditions)||(t.conditions=e(t.conditions,n)),t})}(o.conditions,t),e.setAttributes({wickedBlockConditions:o}),e.setState(function(e){return{action:"view-conditions",activeCondition:null}})}},j("Delete")))))}),M=wp.element.Fragment,V=(0,wp.compose.withState)({active:""})(function(e){var t=e.children,n=e.activePanel,o=t.map(function(e){if(n==e.props.name)return React.createElement("div",{className:"wicked-slider-panel"},e)});return React.createElement("div",{className:"wicked-slider-panels"},o)}),q=function(e){var t=e.children;return React.createElement(M,null,t)},z=wp.i18n.__,Y=lodash,Q=Y.map,W=Y.filter,J=wp.data.withSelect,K=wp.components.SelectControl,X=J(function(e){var t=e("core/editor").getCurrentPost();return{post:t,taxonomies:t?e("core").getTaxonomies():void 0}})(function(e){var t=e.taxonomies,n=e.post,o=e.selectedTaxonomy,i=e.onChange;if(t){var a=W(t,function(e){return-1!==e.types.indexOf(n.type)}),c=Q(a,function(e){return{value:e.slug,label:e.name}});return c.unshift({value:"",label:"Select a taxonomy"}),a.length?React.createElement(K,{label:z("Taxonomy"),value:o,onChange:i,options:c}):React.createElement("p",null,z("No terms can be selected because this post type does not have any taxonomies assigned to it."))}return React.createElement("div",null,z("Loading..."))}),Z=wp.i18n.__,$=lodash,ee=$.map,te=$.filter,ne=$.find,oe=$.union,ie=$.without,ae=wp.data.withSelect,ce=wp.components,re=ce.CheckboxControl,le=ce.FormTokenField,se=ae(function(e,t){var n=t.taxonomy,o=e("core"),i=o.getTaxonomy,a=o.getEntityRecords;return{taxonomyObject:n?i(n):void 0,terms:n?a("taxonomy",n):void 0}})(function(e){e.taxonomy;var t=e.selectedTerms,n=void 0===t?[]:t,o=e.taxonomyObject,i=e.terms,a=e.onChange,c=function(e,t){var o=t?oe(n,[e]):ie(n,e);a(o)};if(o&&i){if(o.hierarchical)return React.createElement("div",{class:"wbc-terms"},React.createElement("h3",null,Z("Terms")),function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return ee(i,function(o){return o.parent==t&&React.createElement("div",{key:o.id,className:"editor-post-taxonomies__hierarchical-terms-choice"},React.createElement(re,{label:o.name,checked:-1!==n.indexOf(o.slug),onChange:function(e){return c(o.slug,e)}}),React.createElement("div",{className:"editor-post-taxonomies__hierarchical-terms-subchoices"},e(o.id)))})}());var r=ee(i,function(e){return e.name}),l=ee(te(i,function(e){return-1!==n.indexOf(e.slug)}),function(e){return e.name});return React.createElement("div",{class:"wbc-terms"},React.createElement(le,{value:l,suggestions:r,maxSuggestions:20,label:Z("Tags"),onChange:function(e){var t=ee(e,function(e){var t=ne(i,{name:e});return t?t.slug:e});a(t)}}))}return!1}),ue=wp.element.Fragment,de=function(e){var t=e.condition,n=e.onChange,o=t.taxonomy,i=t.terms;return React.createElement(ue,null,React.createElement(X,{selectedTaxonomy:o,onChange:function(e){n({taxonomy:e,terms:i})}}),React.createElement(se,{taxonomy:o,selectedTerms:i,onChange:function(e){n({taxonomy:o,terms:e})}}))},pe=wp.i18n.__,me=wp.components.RadioControl,fe=function(e){var t=e.condition,n=e.onChange,o=t.status,i=function(e){n({status:e})};return React.createElement(me,{label:pe("Post Status"),selected:o,options:[{label:pe("Published"),value:"publish"},{label:pe("Pending"),value:"pending"},{label:pe("Draft"),value:"draft"},{label:pe("Future"),value:"future"},{label:pe("Private"),value:"private"},{label:pe("Password Protected"),value:"password"}],onChange:function(e){i(e)}})},ge=wp.i18n.__,he=lodash.assign,ve=wp.date,be=ve.dateI18n,Re=ve.__experimentalGetSettings,we=(wp.element.Fragment,wp.components),Ee=we.RadioControl,Ce=we.DatePicker,ke=we.DateTimePicker,ye=we.Button,xe=we.Dropdown,_e=we.PanelRow,Se=function(e){var t=e.onChange,n=he({},e.condition),o=n.compare,i=n.date,a=ge("between"==o?"Start Date":"Date"),c=Re(),r="same day"==o?c.formats.date:c.formats.datetimeAbbreviated,l=function(e){n.compare=e,t(n)},s=function(e){n.date=e,t(n)};return React.createElement("div",{className:"wbc-current-date-condition"},React.createElement(Ee,{label:ge("Current date is:"),selected:o,options:[{label:ge("Before"),value:"before"},{label:ge("After"),value:"after"},{label:ge("The same as"),value:"same day"}],onChange:function(e){l(e)}}),React.createElement(_e,null,React.createElement("span",null,a),React.createElement("div",null,React.createElement(xe,{className:"wbc-date-popup",contentClassName:"wbc-date-popup-content",position:"bottom right",renderToggle:function(e){var t=e.isOpen,n=e.onToggle;return React.createElement(ye,{onClick:n,"aria-expanded":t,isLink:!0},be(r,i))},renderContent:function(){return React.createElement("div",null,"same day"==o?React.createElement(Ce,{currentDate:i,is12Hour:!0,onChange:function(e){s(e)}}):React.createElement(ke,{currentDate:i,is12Hour:!0,onChange:function(e){s(e)}}))}}))),React.createElement(_e,null,React.createElement("em",null,ge("Note: Be sure that a timezone has been set for your site on the Settings > General page and that the date you select above is for that timezone."))),"between"==o&&React.createElement(_e,null,React.createElement("span",null,ge("End date")),React.createElement("div",null,React.createElement(xe,{className:"wbc-date-popup",contentClassName:"wbc-date-popup-content",position:"bottom right",renderToggle:function(e){var t=e.isOpen,n=e.onToggle;return React.createElement(ye,{onClick:n,"aria-expanded":t,isLink:!0},be(r,dateTwo))},renderContent:function(){return React.createElement("div",null,React.createElement(ke,{currentDate:dateTwo,is12Hour:!0,onChange:function(e){handleChangeDateTwo(e)}}))}}))))},Oe=(wp.i18n.__,lodash),Te=Oe.map,Ne=Oe.union,Pe=Oe.without,Be=wp.data.withSelect,je=wp.components,De=je.CheckboxControl,Ue=je.Spinner,Ae=Be(function(e,t){t.roles;return{roles:(0,e("wicked-plugins/wicked-block-conditions").receiveUserRoles)()}})(function(e){var t=e.selectedRoles,n=void 0===t?[]:t,o=e.roles,i=e.onChange,a=function(e,t){var o=t?Ne(n,[e]):Pe(n,e);i(o)};if(o){var c=Te(o,function(e){return React.createElement(De,{label:e.label,checked:-1!==n.indexOf(e.value),onChange:function(t){return a(e.value,t)}})});return React.createElement("div",{class:"wbc-user-roles"},c)}return React.createElement(Ue,null)}),Fe=function(e){var t=e.condition,n=e.onChange,o=t.roles;return React.createElement(Ae,{selectedRoles:o,onChange:function(e){n({roles:e})}})},Le=wp.i18n.__,He=wp.components.TextControl,Ie=function(e){var t=e.condition,n=e.onChange,o=t.func,i=function(e){n({function:e})};return React.createElement(He,{label:Le("Function"),help:Le("Enter the name of a PHP function to call.  Your function should return a value of true or false.  Any value other than true will be considered false."),value:o,onChange:function(e){return i(e)}})},Ge=wp.i18n.__,Me=wp.components.TextControl,Ve=function(e){var t=e.condition,n=e.onChange,o=t.parameter,i=t.value,a=function(e){n({parameter:e,value:i})},c=function(e){n({parameter:o,value:e})};return React.createElement(React.Fragment,null,React.createElement(Me,{label:Ge("Parameter"),help:Ge("The name of the query string parameter to check."),value:o,onChange:function(e){return a(e)}}),React.createElement(Me,{label:Ge("Value"),help:Ge("The value to check for."),value:i,onChange:function(e){return c(e)}}))},qe=wp.i18n.__,ze=wp.date.date,Ye=function(){return!1},Qe=[];Qe.push({type:"user_is_logged_in",label:qe("User Is Logged In"),group:qe("User Conditions"),description:qe("Returns true if a user is logged in."),bypassConfig:!0,edit:Ye}),Qe.push({type:"user_is_not_logged_in",label:qe("User Is Not Logged In"),group:qe("User Conditions"),description:qe("Returns true if a user is not logged in."),bypassConfig:!0,edit:Ye}),Qe.push({type:"user_has_role",label:qe("User Has Role"),group:qe("User Conditions"),description:qe("Returns true if the user is assigned to any of the selected roles."),edit:Fe}),Qe.push({type:"post_has_term",label:qe("Post Has a Term"),group:qe("Post Conditions"),description:qe("Returns true if the post has the selected term(s) assigned."),bypassConfig:!1,edit:de}),Qe.push({type:"post_status",label:qe("Check Post Status"),group:qe("Post Conditions"),description:qe("Returns true if post status matches the selected option."),bypassConfig:!1,edit:fe,default:{status:"publish"}}),Qe.push({type:"current_date",label:qe("Check The Date"),group:qe("Date Conditions"),description:qe("Returns true if the current date matches the specified conditions."),bypassConfig:!1,edit:Se,default:{compare:"before",date:ze("Y-m-d H:i:00",new Date)}}),Qe.push({type:"user_function",label:qe("Check a User-Defined Function"),group:qe("Advanced"),description:qe("Returns the result of a user-defined function."),bypassConfig:!1,edit:Ie}),Qe.push({type:"query_string",label:qe("Check a Query String Value"),group:qe("Advanced"),description:qe("Returns true if the specified query string parameter is matched."),bypassConfig:!1,edit:Ve,default:{parameter:"",value:""}});n("./src/data/index.js");function We(){return(We=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}var Je=wp.i18n.__,Ke=lodash.assign,Xe=wp.element.Fragment,Ze=wp.components.PanelBody,$e=wp.compose,et=$e.createHigherOrderComponent,tt=$e.withState,nt=wp.editor.InspectorControls,ot=wp.hooks,it=ot.addFilter,at=ot.applyFilters;it("blocks.registerBlockType","wicked-block-conditions/add-attribute",function(e){return e.attributes=Ke(e.attributes,{wickedBlockConditions:{type:"object",default:{action:"show",conditions:[]}}}),e}),it("blocks.getSaveContent.extraProps","wicked-block-conditions/add-props",function(e,t,n){return e.wickedBlockConditions=n.wickedBlockConditions,e});var ct=tt({open:!1,action:"view-conditions",activeCondition:null,group:null})(function(e){return React.createElement(nt,null,React.createElement(Ze,{title:Je("Display Conditions","wicked-block-conditions"),initialOpen:e.open,onToggle:function(){e.setState(function(t){return{open:!e.open}})}},React.createElement(V,{activePanel:e.action},React.createElement(q,{name:"view-conditions"},React.createElement(x,e)),React.createElement(q,{name:"select-condition"},React.createElement(B,e)),React.createElement(q,{name:"edit-condition"},React.createElement(G,e)))))}),rt=et(function(e){var t={conditions:at("wickedBlockConditions.conditions",Qe)};return function(n){return React.createElement(Xe,null,React.createElement(e,n),React.createElement(ct,We({},n,{wickedBlockConditions:t})))}},"withConditions"),lt=wp.hooks,st=lt.addFilter;lt.removeFilter;st("editor.BlockEdit","wicked-block-conditions/with-conditions",rt)},0:function(e,t,n){e.exports=n("./src/index.js")}});